/* map on top + sticky + safe sizing */
.bsf-header { position: sticky; top: 0; z-index: 60; } /* keep header on top */

/* layout: always let map be visually first */
.layout {
  display: flex;
  gap: 16px;
  height: calc(100vh - 64px);
  position: relative;
  z-index: 1;
  flex-direction: column;
  overflow: auto;
}

/* make map shell appear first in visual flow so it's on top */
.map-shell {
  order: -1;                    /* ensures map sits above control panel */
  position: sticky;             /* stays at top while scrolling */
  top: 64px;                    /* sit just below header */
  z-index: 50;                  /* above page content but below header */
  width: 100%;
  height: 50vh;                 /* desktop default */
  min-height: 280px;
  max-height: 75vh;
  margin: 12px 12px 6px 12px;
  border-radius: 12px;
  overflow: visible;
  box-shadow: 0 10px 30px rgba(3,7,18,0.6);
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
}

/* mobile stretch: full below header */
.map-shell.map-full {
  height: calc(100vh - 64px);
  min-height: 360px;
  max-height: none;
  margin: 0;
  border-radius: 0;
}

/* inner map canvas fills the shell */
.map-shell .leaflet-container,
.map-shell .map-canvas,
.map-shell .mapboxgl-map {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  border-radius: inherit;
  will-change: transform;
}

/* control panel sits below map in the flow (no overlap by default) */
.control-panel {
  order: 0;
  width: 320px;
  min-width: 260px;
  max-width: 36%;
  transition: transform 0.22s ease, opacity 0.22s ease;
  z-index: 35;
  display: flex;
  flex-direction: column;
  padding: 10px;
  margin: 12px;
}

/* small helper so content below map can scroll */
.content-below-map {
  flex: 1 1 auto;
  overflow: auto;
  padding: 12px;
}
